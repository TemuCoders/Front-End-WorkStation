<div class="review-list-container">
  <!-- LISTA -->
  @if (facade.reviews().length > 0) {
    <div class="reviews-grid">
      @for (review of facade.reviews(); track review.id) {
        <mat-card
          class="review-card"
          [class.deleted]="review.status === 'DELETED'"
        >
          <mat-card-header>
            <mat-icon mat-card-avatar class="avatar">person</mat-icon>

            <!-- ðŸ‘‡ CAMBIADO -->
            <mat-card-title>
              @if (review.userId === currentUserId) {
                {{ currentUserName || ('User #' + review.userId) }}
              } @else {
                User #{{ review.userId }}
              }
            </mat-card-title>

            <mat-card-subtitle>
              <div class="rating-line">
                @for (star of getStars(review.rating); track $index) {
                  <span class="star">â˜…</span>
                }
                <span class="date">
                  Â· {{ review.createdAt | date : 'medium' }}
                </span>
              </div>
            </mat-card-subtitle>
          </mat-card-header>

          <mat-card-content>
            <p class="comment">{{ review.comment }}</p>

            <mat-chip
              class="status-chip"
              [color]="
                review.status === 'PUBLISHED' ? 'primary' : 'warn'
              "
              selected
            >
              {{ review.status }}
            </mat-chip>
          </mat-card-content>

          <!-- ðŸ‘‡ Ya restringe ediciÃ³n solo al dueÃ±o -->
          @if (review.userId === currentUserId && review.status === 'PUBLISHED') {
            <mat-card-actions align="end">
              <button
                mat-icon-button
                color="primary"
                (click)="editReview(review)"
              >
                <mat-icon>edit</mat-icon>
              </button>
              <button
                mat-icon-button
                color="warn"
                (click)="deleteReview(review.id)"
              >
                <mat-icon>delete</mat-icon>
              </button>
            </mat-card-actions>
          }
        </mat-card>
      }
    </div>
  }

  @if (facade.reviews().length === 0 && !facade.loading()) {
    <div class="no-data">
      {{ 'review.noReviews' | translate }}
    </div>
  }

  @if (facade.loading()) {
    <div class="loading-container">
      <mat-spinner></mat-spinner>
    </div>
  }

  @if (facade.reviews().length > 0) {
    <mat-paginator
      [pageSize]="facade.pageSize()"
      [pageIndex]="facade.currentPage()"
      [pageSizeOptions]="[5, 10, 20]"
      (page)="onPageChange($event)"
    >
    </mat-paginator>
  }
</div>
