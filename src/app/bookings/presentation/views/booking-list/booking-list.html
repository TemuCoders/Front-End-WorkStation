<div class="layout">
  <!-- Sidebar solo si hay usuario -->
  <app-sidebar *ngIf="currentUser() as user"></app-sidebar>

  <div class="booking-list-container">
    <h1>Mis Reservas</h1>

    <!-- Loading State -->
    <div *ngIf="loading" class="loading">
      <p>Cargando tus reservas...</p>
    </div>

    <!-- Empty State -->
    <div *ngIf="!loading && bookings.length === 0" class="empty-state">
      <p>No tienes reservas aún</p>
      <a routerLink="/searching">Explorar espacios</a>
    </div>

    <!-- Bookings Grid -->
    <div *ngIf="!loading && bookings.length > 0" class="bookings-grid">
      <div *ngFor="let booking of bookings" class="booking-card">

        <!-- Header con nombre del espacio -->
        <div class="booking-header">
          <h2 class="ws-title">{{ booking.workspace?.name || 'Espacio no encontrado' }}</h2>
          <span class="booking-status">Confirmado</span>
        </div>

        <!-- Info del workspace en grid -->
        <div class="workspace-details">
          <div class="detail-item">
            <mat-icon class="detail-icon">location_on</mat-icon>
            <div class="detail-content">
              <span class="detail-label">Ubicación</span>
              <span class="detail-value">{{ booking.workspace?.address || 'No disponible' }}</span>
            </div>
          </div>

          <div class="detail-item">
            <mat-icon class="detail-icon">groups</mat-icon>
            <div class="detail-content">
              <span class="detail-label">Capacidad</span>
              <span class="detail-value">{{ booking.workspace?.capacity || 'N/A' }} personas</span>
            </div>
          </div>

          <div class="detail-item">
            <mat-icon class="detail-icon">payments</mat-icon>
            <div class="detail-content">
              <span class="detail-label">Precio por noche</span>
              <span class="detail-value">S/ {{ booking.workspace?.price || 0 }}</span>
            </div>
          </div>

          <div class="detail-item">
            <mat-icon class="detail-icon">business</mat-icon>
            <div class="detail-content">
              <span class="detail-label">Tipo</span>
              <span class="detail-value">{{ booking.workspace?.spaceType || 'Coworking' }}</span>
            </div>
          </div>
        </div>

        <hr />

        <!-- Fechas de la reserva -->
        <div class="booking-dates">
          <div class="date-block">
            <mat-icon class="date-icon">event_available</mat-icon>
            <div class="date-content">
              <span class="date-label">Check-in</span>
              <span class="date-value">{{ booking.startDate }}</span>
            </div>
          </div>
          
          <mat-icon class="date-separator">arrow_forward</mat-icon>
          
          <div class="date-block">
            <mat-icon class="date-icon">event_busy</mat-icon>
            <div class="date-content">
              <span class="date-label">Check-out</span>
              <span class="date-value">{{ booking.endDate }}</span>
            </div>
          </div>
        </div>

        <div class="nights-info">
          <mat-icon class="nights-icon">bedtime</mat-icon>
          <span>{{ booking.nights }} {{ booking.nights === 1 ? 'noche' : 'noches' }}</span>
        </div>

        <hr />

        <!-- Total y booking info -->
        <div class="booking-footer">
          <div class="total-section">
            <span class="total-label">Total pagado</span>
            <span class="total-amount">S/ {{ booking.total }}</span>
          </div>
          <div class="booking-meta">
            <div class="meta-item">
              <mat-icon class="meta-icon">schedule</mat-icon>
              <span class="booking-date">Reservado el {{ booking.bookingDate }}</span>
            </div>
            <div class="meta-item">
              <mat-icon class="meta-icon">confirmation_number</mat-icon>
              <span class="booking-code">#{{ booking.bookingCode }}</span>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>