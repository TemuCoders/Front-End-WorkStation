@if (editedUser(); as user) {
  <div class="layout">

    <app-sidebar></app-sidebar>

    <div class="main">

   <section class="profile-header">
        <img [src]="avatarUrl(user)" alt="avatar" class="avatar-xl" />
        <div class="head-text">
          <h1 class="name">{{ user.name }}</h1>
          <div class="meta">Joined in {{ joinedYear(user) }}</div>
          <span class="profile-role" [ngClass]="user.role.roleName | lowercase">
                {{ user.role.roleName }}
          </span>
        </div>
      </section>


      @if (user.isOwner()) {

        <section class="section">
          <h3 class="section-title">My Workspaces</h3>

          @if (searchLoading()) {
            <div class="loading">Loading workspaces…</div>
          } @else if (searchError()) {
            <div class="error">{{ searchError() }}</div>
          } @else if (myWorkspaces().length === 0) {
            <div class="empty">No workspaces.</div>
          } @else {
            @for (w of myWorkspaces(); track w.spaceId) {
              <article class="workspace-row">
                <div class="w-info">
                  <span class="w-badge">{{ w.spaceType }}</span>
                  <h4 class="w-title">{{ w.name }}</h4>
                  <div class="w-meta">
                    {{ w.capacity }} guests · S/ {{ w.price }}/día · {{ w.address }}
                  </div>
                </div>
                <img
                  [src]="w.images[0] || 'assets/placeholder.jpg'"
                  alt="workspace"
                  class="w-thumb"
                />
              </article>
            }
          }
        </section>
      } @else if (user.isFreelancer()) {

        <section class="section">
          <h3 class="section-title">My Bookings</h3>

          @if (myBooking().length === 0) {
            <div class="empty">No bookings.</div>
          } @else {
            @for (b of myBooking(); track b.bookingCode) {
              <article class="workspace-row">
                <div class="w-info">
                  <span class="w-badge">Booking</span>
                  <h4 class="w-title">Código {{ b.bookingCode }}</h4>
                  <div class="w-meta">
                    Space #{{ b.spaceId }} ·
                    {{ b.startDate }} – {{ b.endDate }}
                  </div>
                </div>
              </article>
            }
          }
        </section>
      }

    </div>
  </div>
} @else {
  <p class="empty">Usuario no encontrado.</p>
  <button mat-stroked-button (click)="goBack()">Volver</button>
}
